<div class="dashboard-container">
  <!-- Filtros superiores -->
  <div class="filtros-container">
    <label>
      Desde:
      <input type="date" [(ngModel)]="fechaDesde" />
    </label>
    <label>
      Hasta:
      <input type="date" [(ngModel)]="fechaHasta" />
    </label>
    <label>
      Turno:
      <select [(ngModel)]="turnoSeleccionado">
        <option value="">Todos</option>
        <option *ngFor="let turno of turnos" [value]="turno">
          {{ turno }}
        </option>
      </select>
    </label>
    <button (click)="aplicarFiltrosLocales()">Filtrar</button>
    <button (click)="quitarFiltros()">Quitar filtros</button>
<button (click)="exportarAExcelConHojasSeparadas()">Exportar a Excel</button>
<button (click)="exportarAExcel()" class="btn btn-success">
  <i class="fas fa-file-excel"></i> Exportar a Excel completo
</button>
  </div>

  <!-- Tarjetas con los gráficos -->
  <div class="graficos-container">
    <div class="special-row">
      <div class="card">
        <h3>PROMEDIO DE RENDIMIENTO</h3>
        <app-rendimiento-promedio
          [RendimientoPerforacion]="RendimientoPerforacion"
          [metas]="metasPorGrafico['PROMEDIO DE RENDIMIENTO']"
        ></app-rendimiento-promedio>
      </div>
      <div class="card">
        <h3>SUMA DE METROS PERFORADOS</h3>
        <app-suma-metros-perforados
          [datos]="datosGraficobarrasapiladas"
          [metas]="metasPorGrafico['SUMA DE METROS PERFORADOS']"
        ></app-suma-metros-perforados>
      </div>

      <div class="card">
        <h3>UTILIZACION - GENERAL</h3>
        <app-utilizacion-general
          [datos]="datosGraficoEstados"
          [metas]="metasPorGrafico['UTILIZACION - GENERAL']"
        ></app-utilizacion-general>
      </div>

      <div class="card">
        <h3>DISPONIBILIDAD MECANICA - GENERAL</h3>
        <app-disponibilidad-mecanica-general
          [datos]="datosGraficoEstados"
          [metas]="metasPorGrafico['DISPONIBILIDAD MECANICA - GENERAL']"
        ></app-disponibilidad-mecanica-general>
      </div>
    </div>

    <div class="card">
      <h3>METROS PERFORADOS - EQUIPO</h3>
      <app-grafico-barras
        [datos]="datosGraficobarrasapiladas"
        [metas]="metasPorGrafico['METROS PERFORADOS - EQUIPO']"
      ></app-grafico-barras>
    </div>

    <div class="card">
      <h3>METROS PERFORADOS - LABOR</h3>
      <app-barras-metro-perforados-labor
        [datos]="datosGraficobarrasapiladas"
        [metas]="metasPorGrafico['METROS PERFORADOS - LABOR']"
      ></app-barras-metro-perforados-labor>
    </div>

    <div class="card">
      <h3>CANTIDAD DE TALADROS - EQUIPO</h3>
      <app-grafico-barras-agrupada
        [datos]="datosGraficobarrasagrupadas"
        [metas]="metasPorGrafico['CANTIDAD DE TALADROS - EQUIPO']"
      ></app-grafico-barras-agrupada>
    </div>

    <div class="card">
      <h3>CANTIDAD DE TALADROS - LABOR</h3>
      <app-grafico-barras-agrupada-num-labor
        [datos]="datosGraficobarrasagrupadas"
        [metas]="metasPorGrafico['CANTIDAD DE TALADROS - LABOR']"
      ></app-grafico-barras-agrupada-num-labor>
    </div>

    <div class="card">
      <h3>LONGITUD DE PERFORACION</h3>
      <app-grafico-barras-metros-labor
        [datos]="datosGraficobarrasapiladas"
        [metas]="metasPorGrafico['LONGITUD DE PERFORACION']"
      ></app-grafico-barras-metros-labor>
    </div>

    <div class="card">
      <h3>PROMEDIO DE TALADROS - SECCION</h3>
      <app-promedio-taladros
        [datos]="paraPromedioTaladrosSeccion"
        [metas]="metasPorGrafico['PROMEDIO DE TALADROS - SECCION']"
      ></app-promedio-taladros>
    </div>

    <!-- <div class="card">
        <h3>promedio de numero taladros por tipo de sección</h3>
        <app-prom-num-taladro-seccion [datos]="ParaPromediostaladrosnumtaladroSeccion"></app-prom-num-taladro-seccion>
      </div> -->

    <div class="card">
      <h3>PROMEDIO DE TALADROS - LABOR</h3>
      <app-prom-num-taladro-tipo-labor
        [datos]="ParaPromediosPromnumtaladrotipolabor"
        [metas]="metasPorGrafico['PROMEDIO DE TALADROS - LABOR']"
      ></app-prom-num-taladro-tipo-labor>
    </div>

    <div class="card">
      <h3>PROMEDIO DE METROS PERFORADOS - SECCION</h3>
      <app-prom-metros-perforados-seccion
        [datos]="ParaPromediostaladrosmetrosperforadosSeccion"
        [metas]="metasPorGrafico['PROMEDIO DE METROS PERFORADOS - SECCION']"
      ></app-prom-metros-perforados-seccion>
    </div>

    <div class="card">
      <h3>ESTADOS</h3>
      <app-grafico-estados [datos]="datosGraficoEstados"></app-grafico-estados>
    </div>

    <div class="card">
      <h3>ESTADOS GENERAL</h3>
      <app-promedio-de-estados-general
        [datos]="datosGraficoEstados"
        [metas]="metasPorGrafico['ESTADOS GENERAL']"
      ></app-promedio-de-estados-general>
    </div>

    <div class="card">
      <h3>HOROMETROS</h3>
      <app-grafico-horometros
        [datosHorometros]="datosHorometros"
        [metas]="metasPorGrafico['HOROMETROS']"
      ></app-grafico-horometros>
    </div>

    <div class="card">
      <h3>RENDIMIENTO DE PERFORACION - EQUIPO</h3>
      <app-rendimiento-de-perforaciones
        [RendimientoPerforacion]="RendimientoPerforacion"
        [metas]="metasPorGrafico['RENDIMIENTO DE PERFORACION - EQUIPO']"
      ></app-rendimiento-de-perforaciones>
    </div>

    <div class="card">
      <h3>DISPONIBILIDAD MECANICA - EQUIPO</h3>
      <app-disponibilidad-mecanica-equipo
        [datos]="datosGraficoEstados"
        [metas]="metasPorGrafico['DISPONIBILIDAD MECANICA - EQUIPO']"
      ></app-disponibilidad-mecanica-equipo>
    </div>

    <div class="card">
      <h3>UTILIZACION - EQUIPO</h3>
      <app-utilizacion-equipo
        [datos]="datosGraficoEstados"
        [metas]="metasPorGrafico['UTILIZACION - EQUIPO']"
      ></app-utilizacion-equipo>
    </div>
  </div>
</div>
